
steps:
        - id: Build Docker Image
          name: 'gcr.io/cloud-builders/docker'
          args: ['build',
                 'env/${_COMPILER}/${_MPI}/${_PLATFORM}/${_ADD_ONS}',
                 '-t',
                 'gcr.io/${PROJECT_ID}/cmg-${_COMPILER}-${_MPI}-${_PLATFORM}_${_ADD_ONS}:${_IMAGE_TAG}'
          ]

images: ['gcr.io/${PROJECT_ID}/cmg-${_COMPILER}-${_MPI}-${_PLATFORM}_${_ADD_ONS}:${_IMAGE_TAG}']

timeout: 14400s

substitutions:
        _IMAGE_TAG: 'latest'
        _COMPILER: 'gcc-10.2.0'
        _MPI: 'serial'
        _PLATFORM: 'x86'
        _ADD_ONS: 'hdf5'

options:
        machineType: 'E2_HIGHCPU_8'
